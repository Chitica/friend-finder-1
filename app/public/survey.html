<!DOCTYPE html>
<html lang="en">
<html>
<head>
  <meta charset="UTF-8">
  <!-- materialize -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/css/materialize.min.css">
  <!-- materialize icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link href="../css/style.css" rel="stylesheet">
  <title>Friend Finder - Survey</title>
</head>
<body>
  <div class='container'>
    <div class='card-panel yellow darken-1 col s12 center-align'>
      <h4><strong>Survey Questions</strong></h4>
        <div class='card-panel left-align white'>
          <h5><strong>About You</strong></h5>
          <br>
          <form action=" ">
            <section class='input-field'>
              <input id="name" type="text" class="validate" required>
              <label class='active' for="name">Name (required)</label>
            </section>
            <section class='input-field'>
              <input id="photo" type="text" class="validate" required>
              <label class='active' for="name">Link to Photo Image (required)</label>
            </section>

            <h5><strong>Question 1</strong></h5>
            <p>I see myself as extraverted, enthusiastic.</p>
            <select data-placeholder="" class="browser-default" id="q1" required>
                <option value="" disabled selected>Choose an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>

            <h5><strong>Question 2</strong></h5>
            <p>I see myself as critical, quarrelsome.</p>
            <select data-placeholder="" class="browser-default" id="q2" required>
                <option value="" disabled selected>Choose an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>

            <h5><strong>Question 3</strong></h5>
            <p>I see myself as dependable, self-disciplined.</p>
            <select data-placeholder="" class="browser-default" id="q3" required>
                <option value="" disabled selected>Choose an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>

            <h5><strong>Question 4</strong></h5>
            <p>I see myself as anxious, easily upset.</p>
            <select data-placeholder="" class="browser-default" id="q4" required>
                <option value="" disabled selected>Choose an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>

            <h5><strong>Question 5</strong></h5>
            <p>I see myself as open to new experiences.</p>
            <select data-placeholder="" class="browser-default" id="q5" required>
                <option value="" disabled selected>Choose an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>

            <h5><strong>Question 6</strong></h5>
            <p>I see myself as reserved, quiet</p>
            <select data-placeholder="" class="browser-default" id="q6" required>
              <option value="" disabled selected>Choose an Option</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>

            <h5><strong>Question 7</strong></h5>
            <p>I see myself as sympathetic.</p>
            <select data-placeholder="" class="browser-default" id="q7" required>
                <option value="" disabled selected>Choose an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>

            <h5><strong>Question 8</strong></h5>
            <p>I see myself as disorganized.</p>
            <select data-placeholder="" class="browser-default" id="q8" required>
                <option value="" disabled selected>Choose an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>

            <h5><strong>Question 9</strong></h5>
            <p>I see myself as calm, emotionally stable.</p>
            <select data-placeholder="" class="browser-default" id="q9" required>
                <option value="" disabled selected>Choose an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>

            <h5><strong>Question 10</strong></h5>
            <p>I see myself as practical, conventional.</p>
            <select data-placeholder="" class="browser-default" id="q10" required>
                <option value="" disabled selected>Choose an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            <br>
            <button type="submit" class="waves-effect waves-light btn cyan lighten-1" id="submitBtn">Submit</button>
          </form>
        </div>
    </div>
    <div class='col s4'>
      <p><a href='/api/friends'>API Friends List</a> | <a href='https://github.com/StefanieDing/friend-finder' target= '_blank'>GitHub Repo</a></p>
    </div>
      <!-- Modal Trigger -->
      <a class="waves-effect waves-light btn modal-trigger" href="#modal1"></a>

      <!-- Modal Structure -->
      <div id="modal1" class="modal">
        <div class="modal-content">
          <h4>Meet Your New BFF</h4>
          <img id="matchPic" src="" alt="">
        </div>
        <div class="modal-footer">
          <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat">X</a>
        </div>
      </div>
  </div>
</body>
</html>

 <!-- jQuery -->
<script src="https://code.jquery.com/jquery.js"></script>
<!-- Compiled and minified JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.8/js/materialize.min.js"></script>
<!-- Grabs information and sends it to server -->
<script type="text/javascript">

  $("#submitBtn").on("click", function(){
    //form validation
    function validateForm() {
      var isValid = true;
      $('.validate').each(function(){
        if($(this).val()===''){
          isValid = false;
        }
      });

      $('.browser-default').each(function(){
        if($(this).val() === ''){
          isValid = false;
        }
      });

      return isValid;
    }

    //if everything is filled
    if(validateForm() == true){

    //creates a new friend from the values submitted
      var newFriend = {
      name: $('#name').val().trim(),
      profilePic: $('#photo').val().trim(),
      scores: [
        $('#q1').val(),
        $('#q2').val(),
        $('#q3').val(),
        $('#q4').val(),
        $('#q5').val(),
        $('#q6').val(),
        $('#q7').val(),
        $('#q8').val(),
        $('#q9').val(),
        $('#q10').val(),
      ]
      };

      //Grabs current URL of website
      var currentURL = window.location.origin;

      //AJAX posts the data to friends API.
      $.post(currentURL + "/api/friends", newFriend, function(data){
        // Grab the result from the AJAX post so that the best match's name and photo are displayed.
        $("#matchName").text(data.name);
        $('#matchPic').attr("src", data.profilePic);

        // Show the modal with the best match
        $('.modal-trigger').leanModal();
      });
    } else{
      alert("Please fill out all fields before submitting survey!")
    }

      //clears value after submission
      $('#name').val('');
      $('#photo').val('');
      $('#q1').val('');
      $('#q2').val('');
      $('#q3').val('');
      $('#q4').val('');
      $('#q5').val('');
      $('#q6').val('');
      $('#q7').val('');
      $('#q8').val('');
      $('#q9').val('');
      $('#q10').val('');

    return false;
  });
  </script>